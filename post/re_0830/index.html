<!doctype html><html dir=ltr lang=en data-theme><head>
<title> Kai Li | Creating multiple subplots using plt.subplots
&lt;link rel="stylesheet" href="https://xiaoshan1994.github.io/css/bootstrap-table.css">
</title>
<meta charset=utf-8><meta name=generator content="Hugo 0.87.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name=description content="Kai Li (李锴)
Leiden University
PhD candidate of Environmental Sciences">
<link rel=stylesheet href=/css/style.min.979f814d8e1a9c71a8b05cff479802bc57043465b6bb1dcd3dbb376b7eda894a.css integrity="sha256-l5+BTY4anHGosFz/R5gCvFcENGW2ux3NPbs3a37aiUo=" crossorigin=anonymous type=text/css>
<link rel=stylesheet href=/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS+yuWSR4=" crossorigin=anonymous type=text/css>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin=anonymous>
<link rel=preconnect href=https://fonts.gstatic.com>
<link href="https://fonts.googleapis.com/css2?family=Kalam&family=Newsreader:wght@600&family=Pattaya&family=Roboto&family=Rock+Salt&family=Patrick+Hand&display=swap" rel=stylesheet>
<link rel=stylesheet href=https://use.typekit.net/btn7hea.css>
<link rel="shortcut icon" href=/favicons/favicon.ico type=image/x-icon>
<link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png>
<link rel=canonical href=/post/re_0830/>
<script type=text/javascript src=/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/anatole-theme-switcher.min.7fd87181cdd7e8413aa64b6867bb32f3a8dc242e684fc7d5bbb9f600dbc2b6eb.js integrity="sha256-f9hxgc3X6EE6pktoZ7sy86jcJC5oT8fVu7n2ANvCtus=" crossorigin=anonymous></script>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://cdn.educba.com/academy/wp-content/uploads/2020/07/psd-9-1-2-2.jpg">
<meta name=twitter:title content="Creating multiple subplots using plt.subplots">
<meta name=twitter:description content="pyplot.subplots creates a figure and a grid of subplots with a single call, while providing reasonable control over how the individual plots are created.">
<meta property="og:title" content="Creating multiple subplots using plt.subplots">
<meta property="og:description" content="pyplot.subplots creates a figure and a grid of subplots with a single call, while providing reasonable control over how the individual plots are created.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://xiaoshan1994.github.io/post/re_0830/"><meta property="og:image" content="https://cdn.educba.com/academy/wp-content/uploads/2020/07/psd-9-1-2-2.jpg"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-08-30T11:31:15+02:00">
<meta property="article:modified_time" content="2021-08-30T11:31:15+02:00"><meta property="og:site_name" content="Blog of Kai">
</head>
<body><div class="sidebar animated fadeInDown">
<div class=logo-title>
<div class=title>
<img src=/images/profile.png alt="profile picture">
<h3 title><a href=/>Blog of Kai</a></h3>
<div class=description>
<h4>Kai Li (李锴)
<br>Leiden University
<br>PhD candidate of Environmental Sciences</h4>
</div>
</div>
</div>
<ul class=social-links>
<li>
<a href=https://www.universiteitleiden.nl/en/staffmembers/1/kai-li#tab-1 rel=me aria-label=university>
<i class="fas fa-university fa-2x" aria-hidden=true></i>
</a>
</li>
<li>
<a href="https://scholar.google.com/citations?user=JcZReB8AAAAJ&hl=zh-CN" rel=me aria-label=google>
<i class="fab fa-google fa-2x" aria-hidden=true></i>
</a>
</li>
<li>
<a href=https://github.com/xiaoshan1994 rel=me aria-label=GitHub>
<i class="fab fa-github fa-2x" aria-hidden=true></i>
</a>
</li>
<li>
<a href=https://twitter.com/xiaoshan1994 rel=me aria-label=twitter>
<i class="fab fa-twitter-square fa-2x" aria-hidden=true></i>
</a>
</li>
<li>
<a href="https://www.facebook.com/profile.php?id=100063897362757" rel=me aria-label=facebook>
<i class="fab fa-facebook-square fa-2x" aria-hidden=true></i>
</a>
</li>
<li>
<a href=mailto:k.li@cml.leidenuniv.nl rel=me aria-label=e-mail>
<i class="fas fa-envelope fa-2x" aria-hidden=true></i>
</a>
</li>
<div class=tw>
<a class=twitter-timeline data-lang=en data-width=400 data-height=500 href="https://twitter.com/xiaoshan1994?ref_src=twsrc%5Etfw" data-chrome="nofooter transparent">
Tweets by xiaoshan1994</a>
<script async src=https://platform.twitter.com/widgets.js></script>
</div>
</ul>
<div class=footer>
<div class=by_farbox>&copy; Kai Li 2020-2021
</div>
</div>
</div>
<div class=main>
<div class="page-top animated fadeInDown">
<a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false>
<span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span>
</a>
<ul class=nav id=navMenu>
<li><a href=/ title>Home</a></li>
<li><a href=/post/ title>Posts</a></li>
<li><a href=/about/ title>About</a></li>
<li><a href=/contact/ title>Contact</a></li>
<li><a href=/ title=EN>EN</a>
</li>
<li><a href=/cn/ title=CN>CN</a>
</li>
<li class=theme-switch-item>
<a class=theme-switch title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div class=autopagerize_page_element>
<div class=content>
<div class="post animated fadeInDown">
<div class=post-content>
<img class=post-thumbnail src=https://cdn.educba.com/academy/wp-content/uploads/2020/07/psd-9-1-2-2.jpg alt="Thumbnail image">
<div class=post-title>
<h1>Creating multiple subplots using plt.subplots</h1>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date>
30/8/2021
</span>
<em class="fas fa-stopwatch"></em>
<span class=reading-time>5-minute read</span>
</div>
</div>
<p>pyplot.subplots creates a figure and a grid of subplots with a single call, while providing reasonable control over how the individual plots are created. For more advanced use cases you can use GridSpec for a more general subplot layout or Figure.add_subplot for adding subplots at arbitrary locations within the figure.<br>
<a href=https://matplotlib.org/stable/gallery/subplots_axes_and_figures/subplots_demo.html>https://matplotlib.org/stable/gallery/subplots_axes_and_figures/subplots_demo.html</a></p>
<p><a href=https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots>matplotlib.pyplot.subplots</a><br>
matplotlib.pyplot.subplots(nrows=1, ncols=1, *, sharex=False, sharey=False, squeeze=True, subplot_kw=None, gridspec_kw=None, **fig_kw)</p>
<p>Returns:<br>
<code>fig</code>: The matplotlib.pyplot.figure object to be used as a <strong>container</strong> for all the subplots.<br>
<code>ax</code>: A single object of the axes. Axes object if there is only <strong>one plot</strong>, or <strong>an array of axes</strong>. Axes objects if there are multiple plots, as specified by the nrows and ncols.</p>
<p>Typical idioms for handling the return value are:<br>
Using the variable ax for single a Axes</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig, ax = plt.subplots()
</code></pre></div><p>Using the variable axs for multiple Axes</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig, axs = plt.subplots(2, 2)
</code></pre></div><p>Using tuple unpacking for multiple Axes</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig, (ax1, ax2) = plt.subplots(1, 2)
fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2)
</code></pre></div><h3 id=a-figure-with-just-one-subplot>A figure with just one subplot</h3>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>import matplotlib.pyplot as plt
import numpy as np

## Some example data to display
x = np.linspace(0, 2 * np.pi, 400)
y = np.sin(x ** 2)
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig, ax = plt.subplots()
ax.plot(x,y)
ax.set_title(&#39;A single plot&#39;)
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131475906-69dd85ff-bcbb-4288-a24e-cf2b9295dfce.png alt=image></p>
<h3 id=stacking-subplots-in-one-direction>Stacking subplots in one direction</h3>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig,ax = plt.subplots(2)
fig.subtitle(&#39;Vertically stacked subplots&#39;)
axs[0].plot(x,y)
axs[1].plot(x,-y)
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131477410-d915bb0d-cc24-456a-8c72-bab48296ff5a.png alt=image></p>
<p>If you are creating just a few Axes, it&rsquo;s handy to unpack them immediately to dedicated variables for each Axes. That way, we can use ax1 instead of the more verbose axs[0].</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig, (ax1,ax2) = plt.subplots(2)
fig.suptitle(&#39;Vertically stacked subplots&#39;)
ax1.plot(x, y)
ax2.plot(x, -y)
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131477875-586ceb55-220a-49a8-8f81-4be319c12bad.png alt=image></p>
<p>To obtain side-by-side subplots, pass parameters 1, 2 for one row and two columns.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig, (ax1,ax2) = plt.subplots(1,2)
fig.subtitle(&#39;Horizontally stacked subplots&#39;)
ax1.plot(x,y)
ax2.plot(x,-y)
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131478295-c31e785f-e621-4c57-96c6-e9c478087212.png alt=image></p>
<h3 id=stacking-subplots-in-two-directions>Stacking subplots in two directions</h3>
<p>When stacking in two directions, the returned <code>axs</code> is a 2D NumPy array.<br>
If you have to set parameters for each subplot it&rsquo;s handy to iterate over all subplots in a 2D grid using <code>for ax in axs.flat</code>:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig,axs = plt.subplots(2,2)
axs[0,0].plot(x,y)
axs[0,0].set_title(&#39;Axis [0, 0]&#39;)
axs[0,1].plot(x,y,&#39;tab:orange&#39;)
axs[0,1].set_title(&#39;Axis [0, 1]&#39;)
axs[1,0].plot(x, -y, &#39;tab:green&#39;)
axs[1,0].set_title(&#39;Axis [1, 0]&#39;)
axs[1,1].plot(x, -y, &#39;tab:red&#39;)
axs[1,1].set_title(&#39;Axis [1, 1]&#39;)

for ax in axs.flat:
ax.set(xlabel=&#39;x-label&#39;,ylabel=&#39;y-label&#39;)

# Hide x labels and tick labels for top plots and y ticks for right plots.
for ax in axs.flat:
    ax.label_outer() # Only show &#34;outer&#34; labels and tick labels. x-labels are only kept for subplots on the last row; y-labels only for subplots on the first column.
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131483362-8726e2b9-631a-40cf-b78b-72dc71beca98.png alt=image></p>
<p>You can use tuple-unpacking also in 2D to assign all subplots to dedicated variables:</p>
<blockquote>
<p>In python tuples are used to store immutable objects. In packing, we put values into a new tuple while in unpacking we extract those values into a single variable.<br>
Packing: a = (&ldquo;MNNIT Allahabad&rdquo;, 5000, &ldquo;Engineering&rdquo;),<br>
Unpacking: (college, student, type_ofcollege) = a.</p>
</blockquote>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig,((ax1,ax2),(ax3,ax4)) = plt.subplots(2,2)
fig.suptitle(&#39;Sharing x per column, y per row&#39;)
ax1.plot(x,y)
ax2.plot(x,y**2,&#39;tab:orange&#39;)
ax3.plot(x,-y,&#39;tab:green&#39;)
ax4.plot(x, -y**2, &#39;tab:red&#39;)
for ax in fig.get_axes():
ax.label_outer()
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131642513-eff75765-a38b-4435-9e2f-7f19af2c0fa2.png alt=image></p>
<h3 id=sharing-axes>Sharing axes</h3>
<p>By default, each Axes is scaled individually. Thus, if the ranges are different the tick values of the subplots do not align.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig, (ax1, ax2) = plt.subplots(2)
fig.suptitle(&#39;Axes values are scaled individually by default&#39;)
ax1.plot(x, y)
ax2.plot(x + 1, -y)
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131644381-699d2759-d34d-4f97-806d-5f0aae2653b5.png alt=image></p>
<p>You can use sharex or sharey to align the horizontal or vertical axis.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig, (ax1, ax2) = plt.subplots(2, sharex=True)
fig.suptitle(&#39;Aligning x-axis using sharex&#39;)
ax1.plot(x, y)
ax2.plot(x + 1, -y)
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131644328-ebcdf740-902e-4989-b819-9a9e4f1b3fe5.png alt=image></p>
<p>Setting sharex or sharey to <code>True</code> enables global sharing across the whole grid, i.e. also the y-axes of vertically stacked subplots have the same scale when using sharey = <code>True</code>.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig, axs = plt.subplots(3, sharex= True, sharey= True)
fig.suptitle(&#39;Sharing both axes&#39;)
axs[0].plot(x, y ** 2)
axs[1].plot(x, 0.3 * y, &#39;o&#39;)
axs[2].plot(x, y, &#39;+&#39;)
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131645322-d62a6c81-fdff-40d4-963e-f8ec8b173588.png alt=image></p>
<p>For subplots that are sharing axes one set of tick labels is enough. Tick labels of inner Axes are automatically removed by sharex and sharey. Still there remains an unused empty space between the subplots.</p>
<p>To precisely control the positioning of the subplots, one can explicitly create a <code>GridSpec</code> with <code>Figure.add_gridspec</code>, and then call its <code>subplots</code> method. For example, we can reduce the height between vertical subplots using <code>add_gridspec(hspace=0)</code>.</p>
<p><code>label_outer</code> is a handy method to remove labels and ticks from subplots that are not at the edge of the grid.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig = plt.figure()
gs = fig.add_gridspec(3, hspace=0)
axs = gs.subplots(sharex= True, sharey = True)
fig.suptitle(&#39;Sharing both axes&#39;)
fig.suptitle(&#39;Sharing both axes&#39;)
axs[0].plot(x, y ** 2)
axs[1].plot(x, 0.3 * y, &#39;o&#39;)
axs[2].plot(x, y, &#39;+&#39;)
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131649016-9975c4c0-402a-449c-8f8c-0e76b46baa9f.png alt=image></p>
<p>Apart from <code>True</code> and <code>False</code>, both <code>sharex</code> and <code>sharey</code> accept the values &lsquo;row&rsquo; and &lsquo;col&rsquo; to share the values only per row or column.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>fig = plt.figure()
gs = fig.add_gridspec(2,2,hspace=0,wspace=0)
(ax1,ax2),(ax3,ax4) = gs.subplots(sharex=&#39;col&#39;, sharey = &#39;row&#39;)
fig.suptitle(&#39;Sharing x per column, y per row&#39;)
ax1.plot(x, y)
ax2.plot(x, y**2, &#39;tab:orange&#39;)
ax3.plot(x + 1, -y, &#39;tab:green&#39;)
ax4.plot(x + 2, -y**2, &#39;tab:red&#39;)
for ax in axs.flat:
ax.label_outer()
</code></pre></div><p><img src=https://user-images.githubusercontent.com/65668613/131649828-b7ab90f6-7a7b-444a-abd1-69dc97ba93c6.png alt=image></p>
<p>If you want a more complex sharing structure, you can first create the grid of axes with no sharing, and then call <code>axes.Axes.sharex</code> or <code>axes.Axes.sharey</code> to add sharing info a posteriori.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fig</span><span class=p>,</span> <span class=nx>axs</span> <span class=p>=</span> <span class=nx>plt</span><span class=p>.</span><span class=nf>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
<span class=nx>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>].</span><span class=nf>plot</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span>
<span class=nx>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>].</span><span class=nf>set_title</span><span class=p>(</span><span class=s>&#34;main&#34;</span><span class=p>)</span>
<span class=nx>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>].</span><span class=nf>plot</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
<span class=nx>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>].</span><span class=nf>set_title</span><span class=p>(</span><span class=s>&#34;shares x with main&#34;</span><span class=p>)</span>
<span class=hl><span class=nx>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>].</span><span class=nf>sharex</span><span class=p>(</span><span class=nx>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>
</span><span class=nx>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>].</span><span class=nf>plot</span><span class=p>(</span><span class=nx>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>y</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<span class=nx>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>].</span><span class=nf>set_title</span><span class=p>(</span><span class=s>&#34;unrelated&#34;</span><span class=p>)</span>
<span class=nx>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>].</span><span class=nf>plot</span><span class=p>(</span><span class=nx>x</span> <span class=o>+</span> <span class=mi>2</span><span class=p>,</span> <span class=nx>y</span> <span class=o>+</span> <span class=mi>2</span><span class=p>)</span>
<span class=nx>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>].</span><span class=nf>set_title</span><span class=p>(</span><span class=s>&#34;also unrelated&#34;</span><span class=p>)</span>
<span class=nx>fig</span><span class=p>.</span><span class=nf>tight_layout</span><span class=p>()</span> <span class=c1>// narrowing the padding between figure edge and edges of the subplots
</span></code></pre></div></div>
<div class=post-footer>
<div class=info>
<span class=separator><a class=category href=/categories/research/>Research</a></span>
<span class=separator><a class=tag href=/tags/python/>python</a><a class=tag href=/tags/matplotlib/>matplotlib</a></span>
</div>
</div>
</div>
</div>
</div>
</div>
<script type=text/javascript src=/js/medium-zoom.min.2d6fd0be87fa98f0c9b4dc2536b312bbca48757f584f6ea1f394abc9bcc38fbc.js integrity="sha256-LW/Qvof6mPDJtNwlNrMSu8pIdX9YT26h85SrybzDj7w=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-123-45','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</body>
</html>